id: go-no-sprintf-in-db-call
language: go
severity: error
message: "Database query uses fmt.Sprintf, which is a SQL injection vulnerability. Use parameterized queries with placeholders ($1, $2, etc.) instead."
rule:
  any:
    - pattern: $DB.Exec($$$, fmt.Sprintf($$$))
    - pattern: $DB.ExecContext($$$, fmt.Sprintf($$$))
    - pattern: $DB.Query($$$, fmt.Sprintf($$$))
    - pattern: $DB.QueryRow($$$, fmt.Sprintf($$$))
    - pattern: $DB.QueryRowContext($$$, fmt.Sprintf($$$))